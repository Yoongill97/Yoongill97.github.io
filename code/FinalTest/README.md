# 최적화 알고리즘을 이용한 회귀식 추정


## 회귀 분석?


회귀분석은 독립변인이 종속변인에 영향을 미치는지 알아보고자 할 때 실시하는 분석방법이다.

간단하게 "키(height)에 따른 몸무게(Weight)"를 예로 들면, W = a + (b * H)  가 되며, 결국 H에 따라 W가 결정되므로, H는 독립변수, W는 종속변수가 된다.
이에 따른 그래프는 다음과 같다.

![그래프](/code/FinalTest/image/graph.png)

## 유전 알고리즘

유전 알고리즘은 자연세계의 진화과정에 기초한 계산 모델로서, 최적화 문제를 해결하는 기법의 하나이다.
생물의 진화를 모방한 진화 연산의 대표적인 기법으로, 실제 진화의 과정에서 많은 부분을 차용하였으며, 변이, 교배 연산 등이 존재한다.

## 구현해보기

### 메인함수

![메인1](/code/FinalTest/image/main1.png)

세대 당 개체수는 POPULATION_SIZE인 100 으로, 돌연변이 발생확률은 1/mutation 로 설정하였다.
첫 세대는 x와 y인자를 가지고 있고, 이는 0에서 9999까지의 난수로 설정해주었다.

![메인2](/code/FinalTest/image/main2.png)

세대가 10번 바뀔때마다 바뀌는 추세를 알 수 있도록 출력해주었다.

### 유전 알고리즘

![func1](/code/FinalTest/image/func1.png)

간단한 식인 Y = 2X + 1 에 가까울 수록 적합도가 높아진다.
적합도 판별식인 (C_worst - C_i) + (C_worst - C_Best) / (k - 1) 에서 k값이 높아질 수록 선택압이 높아진다.
선택압이 너무 높으면, 최적의 해와 최악의 해의 적합도 차이가 클 경우, 나쁜 해들의 선택기회는 거의 없어지게 된다.
즉, 해의 다양성이 급속하게 떨어지는 결과를 가지게 된다.

![choice](/code/FinalTest/image/choice.png)

교배할 두 개체를 고르는 단계이다. 적합도에 비례한 룰렛휠 선택 방법을 채용하였고, 적합도가 클 수록 선택당할 기회가 커진다.

![func2](/code/FinalTest/image/func2.png)

마지막 교배단계이다. 첫번째 선택당한 개체의 x값이 자손의 x값으로, 두번째 선택당한 개체의 y값이 자손의 y값이 된다.
이 때, 돌연변이가 발생하게 된다면, x나 y값이 2배로 커지거나 2배로 작아지게 된다.

### 실행결과

![first](/code/FinalTest/image/first.png)

처음 랜덤으로 생성된 첫 세대의 50개체 중 일부이다. Y = 2X + 1 과는 굉장히 거리가 멀어보인다.

![10](/code/FinalTest/image/10.png)
![20](/code/FinalTest/image/20.png)
![30](/code/FinalTest/image/30.png)

세대를 거듭할 수록 Y = 2X + 1 과 가까워지는 개체들의 속성을 볼 수 있다.

### 돌연변이 확률이 굉장히 높다면 어떻게 될까

mutation 변수의 값을 10으로 고쳐 돌연변이 발생확률이 10%로 굉장히 높게 설정을 했다.

![mut10](/code/FinalTest/image/mut10.png)
![mut20](/code/FinalTest/image/mut20.png)
![mut30](/code/FinalTest/image/mut30.png)

해의 다양성이 굉장히 높아졌지만, Y = 2X + 1 에 가까워지는 것은 어려워보인다.

![mut100](/code/FinalTest/image/mut100.png)

세대를 100번을 반복한 경우에는 조금 더 Y = 2X + 1 에 가까워지지만, 정확도가 조금 떨어진다.

## 유전 알고리즘을 사용하는 이유

>유전 알고리즘의 장점

>>1. 복수의 개체 사이에서 선택이나 교배 등의 유전자 조작에 의해서 상호 협력적으로 해의 탐색을 수행하기 때문에, 단순한 병렬적 해의 탐색과 비교하여 보다 좋은 해를 발견하기 쉽다.

>>2. 유전 알고리즘에서는 현재의 적응, 적합도를 분별할 수 있기만 하면 알고리즘을 짜는데 있어서 다른 접근 방법에 비해 단순하며, 평가 함수가 불연속인 경우에도 적용이 가능하다.

>유전 알고리즘의 단점

>>1. 대상으로 하는 문제를 해결하기 위한 일반적인 방법이 없다.

>>2. 개체수, 선택 방법이나 교배법의 결정, 돌연변이 확률 등의 필요 변수가 많다.